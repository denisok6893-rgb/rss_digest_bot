# CONTINUITY ‚Äî rss_digest_bot

## –ß—Ç–æ —ç—Ç–æ
Telegram-–±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å RSS-–ª–µ–Ω—Ç–∞–º–∏.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- /add /list /del ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RSS-–∫–∞–Ω–∞–ª–∞–º–∏
- /sync ‚Äî —Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ SQLite)
- /news ‚Äî –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
- /news week ‚Äî –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

---

## –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å (–≤–∞–∂–Ω–æ)
–ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑:
  ./run.sh

–ï—Å–ª–∏ –±–æ—Ç ‚Äú–º–æ–ª—á–∏—Ç‚Äù ‚Äî –ø–µ—Ä–≤–æ–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- —á—Ç–æ –æ–Ω –∑–∞–ø—É—â–µ–Ω –∏–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ ./run.sh
- —á—Ç–æ systemd-—Å–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–µ–Ω

---

## –•—Ä–∞–Ω–∏–ª–∏—â–µ
- SQLite: data/rss.db (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
- .env —Å BOT_TOKEN (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
- Python + venv
- requirements.txt —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä: /opt/rss_digest_bot
- –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd, —Ä–µ–∂–∏–º polling

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç rss_digest_bot.
–ë–æ—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (/opt/rss_digest_bot) –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ systemd –≤ —Ä–µ–∂–∏–º–µ polling.
–†–∞–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∞—Å—Ç–∏—á–Ω–æ –¥–µ–ª–∞–ª–∏—Å—å –ª–æ–∫–∞–ª—å–Ω–æ (Termux), –∏–∑-–∑–∞ —á–µ–≥–æ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è.
–°–µ–π—á–∞—Å —Å–µ—Ä–≤–µ—Ä ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã.

---

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### UI –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–æ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å Reply-–∫–Ω–æ–ø–∫–∞–º–∏:
- üì∞ –°–µ–≥–æ–¥–Ω—è
- üìÖ –ù–µ–¥–µ–ª—è
- ‚ûï –î–æ–±–∞–≤–∏—Ç—å RSS
- üìÉ –ú–æ–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í—ã–Ω–µ—Å–µ–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å:
- app/keyboards/main_menu.py
- –¥–æ–±–∞–≤–ª–µ–Ω—ã __init__.py –≤ app/ –∏ app/keyboards/

/start —Ç–µ–ø–µ—Ä—å:
- –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–º
- –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —á–µ—Ä–µ–∑ reply_markup=main_menu_keyboard()

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω handle_menu_buttons:
- –∫–Ω–æ–ø–∫–∏ –≤—ã–∑—ã–≤–∞—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è update.message.text (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω AttributeError)
### –ê–≤—Ç–æ-sync –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

- –ù–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ-sync —á–µ—Ä–µ–∑ systemd timer  
  –°–µ—Ä–≤–∏—Å: `rss_digest_bot_sync.service`  
  –¢–∞–π–º–µ—Ä: `rss_digest_bot_sync.timer` (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)

- –î–æ–±–∞–≤–ª–µ–Ω CLI-—Ä–µ–∂–∏–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

---

### –î–µ–ø–ª–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
- application.add_handler ‚Üí app.add_handler
- –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç ContextTypes

–ö—Ä–∏—Ç–∏—á–Ω—ã–π —Ñ–∏–∫—Å –¥–µ–ø–ª–æ—è:
- systemd –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç –∫–∞–∫ –º–æ–¥—É–ª—å:
  ExecStart=/opt/rss_digest_bot/.venv/bin/python -m app.main
- –∑–∞–¥–∞–Ω WorkingDirectory=/opt/rss_digest_bot
- —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ ModuleNotFoundError: No module named 'app'

---

### –õ–æ–≥–∏–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
–ü—Ä–æ–±–ª–µ–º–∞: ‚Äú–°–µ–≥–æ–¥–Ω—è‚Äù –∏ ‚Äú–ù–µ–¥–µ–ª—è‚Äù –≤—ã–¥–∞–≤–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ.
–ü—Ä–∏—á–∏–Ω–∞: –∫–Ω–æ–ø–∫–∞ ‚Äú–ù–µ–¥–µ–ª—è‚Äù –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞ –∞—Ä–≥—É–º–µ–Ω—Ç week, –ø–ª—é—Å –±—ã–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

–°–¥–µ–ª–∞–Ω–æ:
- –∫–Ω–æ–ø–∫–∞ ‚Äú–ù–µ–¥–µ–ª—è‚Äù –ø–µ—Ä–µ–¥–∞—ë—Ç context.args = ["week"]
- –∏—Å–ø—Ä–∞–≤–ª–µ–Ω search_news_advanced:
  - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
  - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ query –∏ category
  - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ published_at DESC
- get_today_news –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –Ω–∞ localtime:
  - date(published_at, 'localtime') = date('now', 'localtime')

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚Äú–°–µ–≥–æ–¥–Ω—è‚Äù –∏ ‚Äú–ù–µ–¥–µ–ª—è‚Äù —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è
- /news week —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

---

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ UX
- /sync –æ—Å—Ç–∞—ë—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
- –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–±—Ä–∞–Ω–æ –ª–∏—à–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äú–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞‚Äù (—Ç–∏—Ö–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –≤—ã–¥–∞—á–∏)

---

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏ –∑–∞–ø—É—à–µ–Ω—ã
- –¥–æ–±–∞–≤–ª–µ–Ω app/scheduler.py (–∑–∞–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–¥ –∞–≤—Ç–æ-sync)
- –æ–±–Ω–æ–≤–ª—ë–Ω requirements.txt (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- –∫–Ω–æ–ø–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚Äú–°–µ–≥–æ–¥–Ω—è‚Äù –∏ ‚Äú–ù–µ–¥–µ–ª—è‚Äù –æ—Ç–ª–∏—á–∞—é—Ç—Å—è
- —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ systemd –±–µ–∑ ModuleNotFoundError

---

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è / –¥–æ–ª–≥–∏
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞
- –Ω–µ—Ç /news month
- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–º–µ/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –µ—Å—Ç—å –≤ cmd_news, –Ω–æ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–∏—Ä–æ–≤–∞—Ç—å UX –∏ –ª–∏–º–∏—Ç—ã
- –∞–≤—Ç–æ-sync –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –µ—â—ë –Ω–µ –≤–∫–ª—é—á—ë–Ω (–µ—Å—Ç—å –∑–∞–≥–æ—Ç–æ–≤–∫–∞ scheduler)

---

##python -m app.main sync
–í—ã–ø–æ–ª–Ω—è–µ—Ç sync –∏ **–≤—ã—Ö–æ–¥–∏—Ç**, –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ polling

- –£—Å—Ç—Ä–∞–Ω—ë–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç Telegram:

##Conflict: terminated by other getUpdates request
–ü—Ä–∏—á–∏–Ω–∞ –±—ã–ª–∞ –≤ –∑–∞–ø—É—Å–∫–µ –≤—Ç–æ—Ä–æ–≥–æ polling-–ø—Ä–æ—Ü–µ—Å—Å–∞ —Ç–∞–π–º–µ—Ä–æ–º  
–†–µ—à–µ–Ω–∏–µ: —Ç–∞–π–º–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CLI-sync, polling –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º

## –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–æ–¥–∏–Ω)
–°–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ-sync –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:
- –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ systemd timer
- –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ —á–µ—Ä–µ–∑ app/scheduler.py (–µ—Å–ª–∏ —Ä–µ—à–∏–º –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞)
